<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>phpIPAM Health Monitor - éƒ¨ç½²æŒ‡å— v2.1</title>
    <style>
        :root {
            --bg: #0f172a;
            --bg2: #1e293b;
            --card: #334155;
            --text: #f1f5f9;
            --text2: #94a3b8;
            --green: #22c55e;
            --blue: #3b82f6;
            --orange: #f97316;
            --purple: #a855f7;
            --red: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        h1 {
            font-size: 2.2rem;
            text-align: center;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--blue), var(--purple));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            text-align: center;
            color: var(--text2);
            margin-bottom: 30px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 0;
            border-bottom: 2px solid var(--card);
        }

        .tab {
            padding: 14px 28px;
            background: var(--bg2);
            border: none;
            color: var(--text2);
            cursor: pointer;
            font-size: 1rem;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s;
        }

        .tab:hover {
            background: var(--card);
            color: var(--text);
        }

        .tab.active {
            background: var(--blue);
            color: white;
        }

        .tab-content {
            display: none;
            background: var(--bg2);
            padding: 30px;
            border-radius: 0 8px 8px 8px;
            border: 1px solid var(--card);
            border-top: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Sections */
        .section {
            margin-bottom: 30px;
        }

        h2 {
            font-size: 1.4rem;
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--blue);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h3 {
            font-size: 1.1rem;
            color: var(--blue);
            margin: 20px 0 12px 0;
        }

        h4 {
            font-size: 1rem;
            color: var(--orange);
            margin: 16px 0 8px 0;
        }

        /* Code blocks */
        .code-wrapper {
            position: relative;
            margin: 12px 0;
        }

        pre {
            background: #0a0f1a;
            padding: 18px;
            padding-right: 70px;
            border-radius: 10px;
            overflow-x: auto;
            font-size: 0.9rem;
            border: 1px solid var(--card);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        code {
            color: var(--green);
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            padding: 6px 12px;
            background: #475569;
            border: none;
            color: var(--text);
            cursor: pointer;
            border-radius: 6px;
            font-size: 0.8rem;
            transition: all 0.2s;
            z-index: 10;
        }

        .copy-btn:hover {
            background: var(--blue);
            color: white;
        }

        .copy-btn.copied {
            background: var(--green);
            color: white;
        }

        /* Inline code */
        .code-inline {
            background: rgba(59, 130, 246, 0.15);
            padding: 3px 8px;
            border-radius: 4px;
            color: var(--blue);
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }

        th,
        td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid var(--card);
        }

        th {
            color: var(--text2);
            font-size: 0.85rem;
            text-transform: uppercase;
            background: rgba(51, 65, 85, 0.3);
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge.get {
            background: rgba(34, 197, 94, 0.2);
            color: var(--green);
        }

        .badge.post {
            background: rgba(59, 130, 246, 0.2);
            color: var(--blue);
        }

        .badge.put {
            background: rgba(249, 115, 22, 0.2);
            color: var(--orange);
        }

        .badge.delete {
            background: rgba(239, 68, 68, 0.2);
            color: var(--red);
        }

        /* Alerts */
        .note {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid var(--blue);
            padding: 16px 20px;
            border-radius: 0 8px 8px 0;
            margin: 16px 0;
        }

        .warning {
            background: rgba(249, 115, 22, 0.1);
            border-left: 4px solid var(--orange);
            padding: 16px 20px;
            border-radius: 0 8px 8px 0;
            margin: 16px 0;
        }

        .success {
            background: rgba(34, 197, 94, 0.1);
            border-left: 4px solid var(--green);
            padding: 16px 20px;
            border-radius: 0 8px 8px 0;
            margin: 16px 0;
        }

        /* Step indicator */
        .step {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            margin: 20px 0;
            padding: 20px;
            background: var(--card);
            border-radius: 10px;
            overflow: visible;
        }

        .step-num {
            min-width: 36px;
            height: 36px;
            background: var(--blue);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .step-content {
            flex: 1;
            min-width: 0;
            overflow: visible;
        }

        .step-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        /* One-click deploy button */
        .deploy-btn {
            display: inline-block;
            padding: 14px 28px;
            background: linear-gradient(135deg, var(--green), #16a34a);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 16px 0;
            transition: transform 0.2s;
        }

        .deploy-btn:hover {
            transform: translateY(-2px);
        }

        /* API endpoint */
        .api-endpoint {
            background: var(--card);
            border-radius: 10px;
            padding: 20px;
            margin: 16px 0;
        }

        .api-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .api-path {
            font-family: 'Consolas', monospace;
            font-size: 1rem;
        }

        .api-desc {
            color: var(--text2);
            margin-bottom: 12px;
        }

        /* Footer */
        .footer {
            text-align: center;
            color: var(--text2);
            font-size: 0.9rem;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid var(--card);
        }

        ul,
        ol {
            padding-left: 24px;
            margin: 12px 0;
        }

        li {
            margin: 8px 0;
        }

        a {
            color: var(--blue);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ“Š phpIPAM Health Monitor</h1>
        <p class="subtitle">éƒ¨ç½²æŒ‡å— v2.1 | 2025-12-23</p>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('new-install')">ğŸ†• æ–°å®‰è£</button>
            <button class="tab" onclick="switchTab('upgrade')">â¬†ï¸ ç‰ˆæœ¬å‡ç´š</button>
            <button class="tab" onclick="switchTab('api')">ğŸ“š API æ–‡ä»¶</button>
        </div>

        <!-- Tab 1: æ–°å®‰è£ -->
        <div id="new-install" class="tab-content active">
            <div class="section">
                <h2>ğŸ†• æ–°å®‰è£ç”¨æˆ¶éƒ¨ç½²æŒ‡å—</h2>
                <p>é©ç”¨æ–¼é¦–æ¬¡å®‰è£ phpIPAM Health Monitor çš„ç”¨æˆ¶ã€‚</p>

                <div class="success">
                    <strong>âœ¨ ä¸€éµéƒ¨ç½²</strong>
                    <p>å¦‚æœæ‚¨çš„ç’°å¢ƒå·²æœ‰é‹è¡Œä¸­çš„ phpIPAM Docker å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸€éµéƒ¨ç½²è…³æœ¬ï¼š</p>
                </div>

                <div class="code-wrapper">
                    <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                    <pre><code># ä¸€éµéƒ¨ç½² Health Monitor (åŒ…å« Dashboard + phpIPAM Tools æ•´åˆ)
curl -sL https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/scripts/full_deploy.sh | bash</code></pre>
                </div>

                <h3>å‰ç½®éœ€æ±‚</h3>
                <ul>
                    <li>phpIPAM Docker å®¹å™¨å·²é‹è¡Œ (phpipam_phpipam-web_1)</li>
                    <li>MariaDB å®¹å™¨å·²é‹è¡Œ (phpipam_phpipam-mariadb_1)</li>
                    <li>Cron å®¹å™¨å·²é‹è¡Œ (phpipam_phpipam-cron_1)</li>
                    <li>å…·æœ‰ root æ¬Šé™</li>
                </ul>

                <h3>é€æ­¥å®‰è£</h3>

                <div class="step">
                    <div class="step-num">1</div>
                    <div class="step-content">
                        <div class="step-title">å»ºç«‹è³‡æ–™è¡¨</div>
                        <p>åœ¨ MariaDB ä¸­å»ºç«‹ Health Monitor æ‰€éœ€çš„è³‡æ–™è¡¨ï¼š</p>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code># ä¸‹è¼‰ä¸¦åŸ·è¡Œ SQL
curl -sL https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/database/health_check_tables.sql -o /tmp/health_check_tables.sql

# åŒ¯å…¥åˆ°è³‡æ–™åº«
docker exec -i phpipam_phpipam-mariadb_1 mariadb -u phpipam -pmy_secret_phpipam_pass phpipam < /tmp/health_check_tables.sql</code></pre>
                        </div>
                        <p><strong>é©—è­‰ï¼š</strong></p>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code>docker exec phpipam_phpipam-mariadb_1 mariadb -u phpipam -pmy_secret_phpipam_pass phpipam -e "SHOW TABLES LIKE 'health_check%';"</code></pre>
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-num">2</div>
                    <div class="step-content">
                        <div class="step-title">éƒ¨ç½² Health Dashboard</div>
                        <p>ä¸‹è¼‰ä¸¦éƒ¨ç½² Dashboard åˆ° Web å®¹å™¨ï¼š</p>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code># å»ºç«‹ç›®éŒ„çµæ§‹
docker exec phpipam_phpipam-web_1 mkdir -p /phpipam/health_dashboard/api
docker exec phpipam_phpipam-web_1 mkdir -p /phpipam/health_dashboard/config
docker exec phpipam_phpipam-web_1 mkdir -p /phpipam/health_dashboard/includes

# ä¸‹è¼‰æª”æ¡ˆ
mkdir -p /tmp/health_deploy && cd /tmp/health_deploy
curl -sLO https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/dashboard/index.html
curl -sLO https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/api/api_stats.php
curl -sLO https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/api/api_dhcp_config.php
curl -sLO https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/includes/StatsCalculator.php
curl -sLO https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/includes/HistoryCollector.php
curl -sLO https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/config/dhcp_servers.json

# è¤‡è£½åˆ°å®¹å™¨
docker cp index.html phpipam_phpipam-web_1:/phpipam/health_dashboard/
docker cp api_stats.php phpipam_phpipam-web_1:/phpipam/health_dashboard/api/
docker cp api_dhcp_config.php phpipam_phpipam-web_1:/phpipam/health_dashboard/api/
docker cp StatsCalculator.php phpipam_phpipam-web_1:/phpipam/health_dashboard/includes/
docker cp HistoryCollector.php phpipam_phpipam-web_1:/phpipam/health_dashboard/includes/
docker cp dhcp_servers.json phpipam_phpipam-web_1:/phpipam/health_dashboard/config/</code></pre>
                        </div>
                        <p><strong>é©—è­‰ï¼š</strong></p>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code>curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=latest" | head -c 100</code></pre>
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-num">3</div>
                    <div class="step-content">
                        <div class="step-title">è¨­å®š Cron å®¹å™¨</div>
                        <p>éƒ¨ç½²è³‡æ–™æ”¶é›†è…³æœ¬åˆ° Cron å®¹å™¨ï¼š</p>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code># å»ºç«‹ç›®éŒ„
docker exec phpipam_phpipam-cron_1 mkdir -p /health_check/scripts
docker exec phpipam_phpipam-cron_1 mkdir -p /health_check/includes
docker exec phpipam_phpipam-cron_1 mkdir -p /health_check/config

# ä¸‹è¼‰è…³æœ¬
curl -sL https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/scripts/collect_stats.php -o /tmp/collect_stats.php

# è¤‡è£½åˆ° Cron å®¹å™¨
docker cp /tmp/collect_stats.php phpipam_phpipam-cron_1:/health_check/scripts/
docker cp /tmp/health_deploy/StatsCalculator.php phpipam_phpipam-cron_1:/health_check/includes/
docker cp /tmp/health_deploy/HistoryCollector.php phpipam_phpipam-cron_1:/health_check/includes/
docker cp /tmp/health_deploy/dhcp_servers.json phpipam_phpipam-cron_1:/health_check/config/

# è¨­å®š Cron Job (æ¯ 5 åˆ†é˜åŸ·è¡Œ)
docker exec phpipam_phpipam-cron_1 sh -c 'echo "*/5 * * * * php /health_check/scripts/collect_stats.php >> /var/log/health_check.log 2>&1" >> /etc/crontabs/root'</code></pre>
                        </div>
                        <p><strong>é©—è­‰ï¼š</strong></p>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code>docker exec phpipam_phpipam-cron_1 php /health_check/scripts/collect_stats.php</code></pre>
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-num">4</div>
                    <div class="step-content">
                        <div class="step-title">æ•´åˆåˆ° phpIPAM Tools é¸å–®</div>
                        <p>å°‡ Health Monitor åµŒå…¥åˆ° phpIPAM çš„ Tools é¸å–®ï¼š</p>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code># åŸ·è¡Œæ•´åˆè…³æœ¬
curl -sL https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/scripts/setup_phpipam_integration.sh -o /tmp/setup.sh
chmod +x /tmp/setup.sh
/tmp/setup.sh</code></pre>
                        </div>
                        <p><strong>é©—è­‰ï¼š</strong></p>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code># è¨ªå• phpIPAMï¼Œç¢ºèª Tools â†’ Custom Tools â†’ Health-monitor å‡ºç¾
curl -sk "https://YOUR_SERVER/index.php?page=tools&section=health-monitor" | grep -o "Health Monitor"</code></pre>
                        </div>
                    </div>
                </div>

                <div class="success">
                    <strong>ğŸ‰ å®‰è£å®Œæˆï¼</strong>
                    <p>è¨ªå•ï¼š<code>https://YOUR_SERVER/health_dashboard/</code> æˆ–
                        <code>https://YOUR_SERVER/index.php?page=tools&section=health-monitor</code>
                    </p>
                </div>
            </div>
        </div>

        <!-- Tab 2: ç‰ˆæœ¬å‡ç´š -->
        <div id="upgrade" class="tab-content">
            <div class="section">
                <h2>â¬†ï¸ ç‰ˆæœ¬å‡ç´šç”¨æˆ¶æŒ‡å—</h2>
                <p>ç•¶ phpIPAM å®˜æ–¹ç‰ˆæœ¬å‡ç´šæ™‚ï¼Œéœ€è¦é‡æ–°éƒ¨ç½² Health Monitorã€‚</p>

                <div class="warning">
                    <strong>âš ï¸ é‡è¦æé†’</strong>
                    <p>phpIPAM å‡ç´šæœƒè¦†è“‹ä»¥ä¸‹äºŒæ¬¡é–‹ç™¼çš„æª”æ¡ˆï¼š</p>
                    <ul>
                        <li><code>/phpipam/app/tools/health-monitor/</code> - æœƒè¢«è¦†è“‹</li>
                        <li><code>/phpipam/app/tools/tools-menu-config.php</code> - æœƒè¢«è¦†è“‹</li>
                        <li><code>/phpipam/config.php</code> - å¯èƒ½è¢«è¦†è“‹</li>
                        <li><code>/phpipam/health_dashboard/</code> - å¯èƒ½è¢«è¦†è“‹ (å–æ±ºæ–¼ volume è¨­å®š)</li>
                    </ul>
                    <p>è³‡æ–™åº« <code>health_check_*</code> è¡¨æ ¼ä¸å—å½±éŸ¿ã€‚</p>
                </div>

                <h3>å‡ç´šå‰å‚™ä»½</h3>
                <div class="code-wrapper">
                    <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                    <pre><code># å‚™ä»½æ‰€æœ‰ Health Monitor ç›¸é—œæª”æ¡ˆ
mkdir -p /opt/backup/health_monitor_$(date +%Y%m%d)
docker cp phpipam_phpipam-web_1:/phpipam/config.php /opt/backup/health_monitor_$(date +%Y%m%d)/
docker cp phpipam_phpipam-web_1:/phpipam/health_dashboard /opt/backup/health_monitor_$(date +%Y%m%d)/
docker cp phpipam_phpipam-web_1:/phpipam/app/tools/health-monitor /opt/backup/health_monitor_$(date +%Y%m%d)/
docker cp phpipam_phpipam-cron_1:/health_check /opt/backup/health_monitor_$(date +%Y%m%d)/</code></pre>
                </div>

                <h3>å‡ç´šå¾Œæ¢å¾© (ä¸€éµ)</h3>
                <div class="success">
                    <strong>âœ¨ ä¸€éµæ¢å¾©</strong>
                    <p>phpIPAM å‡ç´šå®Œæˆå¾Œï¼ŒåŸ·è¡Œä»¥ä¸‹å‘½ä»¤æ¢å¾© Health Monitorï¼š</p>
                </div>
                <div class="code-wrapper">
                    <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                    <pre><code># ä¸€éµæ¢å¾© Health Monitor
curl -sL https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/scripts/full_deploy.sh | bash</code></pre>
                </div>

                <h3>å‡ç´šå¾Œæ¢å¾© (é€æ­¥)</h3>

                <div class="step">
                    <div class="step-num">1</div>
                    <div class="step-content">
                        <div class="step-title">æ¢å¾© Dashboard</div>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code>mkdir -p /tmp/health_update && cd /tmp/health_update
curl -sLO https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/api/api_stats.php
curl -sLO https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/dashboard/index.html

docker exec phpipam_phpipam-web_1 mkdir -p /phpipam/health_dashboard/api
docker cp api_stats.php phpipam_phpipam-web_1:/phpipam/health_dashboard/api/
docker cp index.html phpipam_phpipam-web_1:/phpipam/health_dashboard/</code></pre>
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-num">2</div>
                    <div class="step-content">
                        <div class="step-title">æ¢å¾© phpIPAM Tools æ•´åˆ</div>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code>curl -sL https://raw.githubusercontent.com/nox913106/DEV-phpipam/master/scripts/setup_phpipam_integration.sh | bash</code></pre>
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-num">3</div>
                    <div class="step-content">
                        <div class="step-title">é©—è­‰åŠŸèƒ½</div>
                        <div class="code-wrapper">
                            <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                            <pre><code># é©—è­‰ API
curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=latest" | head -c 100

# é©—è­‰ Tools æ•´åˆ
curl -sk "https://YOUR_SERVER/index.php?page=tools&section=health-monitor" | grep -c "Health Monitor"

# é©—è­‰è³‡æ–™æ”¶é›†
docker exec phpipam_phpipam-cron_1 php /health_check/scripts/collect_stats.php</code></pre>
                        </div>
                    </div>
                </div>

                <h3>æ°¸ä¹…è§£æ±ºæ–¹æ¡ˆï¼šDocker Volume æŒä¹…åŒ–</h3>
                <p>ä¿®æ”¹ <code>docker-compose.yml</code> æ·»åŠ  volume æ˜ å°„ï¼Œè®“ Health Dashboard åœ¨å‡ç´šå¾Œè‡ªå‹•ä¿ç•™ï¼š</p>
                <div class="code-wrapper">
                    <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                    <pre><code>services:
  phpipam-web:
    volumes:
      - phpipam-health-dashboard:/phpipam/health_dashboard

volumes:
  phpipam-health-dashboard:</code></pre>
                </div>
                <div class="note">
                    <strong>ğŸ’¡ æ³¨æ„</strong>
                    <p>å³ä½¿é…ç½®äº† volumeï¼Œ<code>tools-menu-config.php</code> å’Œ <code>config.php</code> ä»éœ€è¦åœ¨å‡ç´šå¾Œé‡æ–°åŸ·è¡Œ
                        <code>setup_phpipam_integration.sh</code> è…³æœ¬æ¢å¾©ã€‚
                    </p>
                </div>
            </div>
        </div>

        <!-- Tab 3: API æ–‡ä»¶ -->
        <div id="api" class="tab-content">
            <div class="section">
                <h2>ğŸ“š API åƒè€ƒæ–‡ä»¶</h2>
                <p>Health Monitor v2.1 æä¾›ä»¥ä¸‹ API ç«¯é»ï¼š</p>

                <h3>Base URL</h3>
                <div class="code-wrapper">
                    <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                    <pre><code>https://YOUR_SERVER/health_dashboard/api/</code></pre>
                </div>

                <!-- API: Latest -->
                <div class="api-endpoint">
                    <div class="api-header">
                        <span class="badge get">GET</span>
                        <span class="api-path">/api_stats.php?action=latest</span>
                    </div>
                    <p class="api-desc">å–å¾—æœ€æ–°ç³»çµ±ç‹€æ…‹å’Œ DHCP ä¼ºæœå™¨ç‹€æ…‹</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=latest"</code></pre>
                    </div>
                    <h4>å›æ‡‰ç¯„ä¾‹</h4>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>{
  "success": true,
  "data": {
    "system": {
      "cpu_usage_percent": "2.29",
      "memory_usage_percent": "16.79",
      "disk_usage_percent": "64.57",
      "recorded_at": "2025-12-23 13:15:00"
    },
    "dhcp": [
      {"dhcp_ip": "172.16.5.196", "dhcp_hostname": "DHCP-CH-HQ2", "reachable": 1, "latency_ms": "0.45"}
    ]
  },
  "generated_at": "2025-12-23T13:20:00+08:00"
}</code></pre>
                    </div>
                </div>

                <!-- API: System History -->
                <div class="api-endpoint">
                    <div class="api-header">
                        <span class="badge get">GET</span>
                        <span class="api-path">/api_stats.php?action=system_history</span>
                    </div>
                    <p class="api-desc">å–å¾—ç³»çµ±è³‡æºæ­·å²è³‡æ–™ (CPU/Memory/Disk)</p>

                    <h4>åƒæ•¸</h4>
                    <table>
                        <tr>
                            <th>åƒæ•¸</th>
                            <th>é¡å‹</th>
                            <th>èªªæ˜</th>
                            <th>é è¨­å€¼</th>
                        </tr>
                        <tr>
                            <td><code>hours</code></td>
                            <td>int</td>
                            <td>å›ºå®šæ™‚æ®µ (1/3/6/8/12/24)</td>
                            <td>24</td>
                        </tr>
                        <tr>
                            <td><code>start_time</code></td>
                            <td>string</td>
                            <td>è‡ªè¨‚é–‹å§‹æ™‚é–“ (Y-m-d H:i)</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td><code>end_time</code></td>
                            <td>string</td>
                            <td>è‡ªè¨‚çµæŸæ™‚é–“ (Y-m-d H:i)</td>
                            <td>-</td>
                        </tr>
                    </table>

                    <h4>å›ºå®šæ™‚æ®µæŸ¥è©¢</h4>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=system_history&hours=3"</code></pre>
                    </div>

                    <h4>è‡ªè¨‚æ™‚é–“ç¯„åœæŸ¥è©¢</h4>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=system_history&start_time=2025-12-22%2000:00&end_time=2025-12-22%2005:00"</code></pre>
                    </div>
                </div>

                <!-- API: DHCP History -->
                <div class="api-endpoint">
                    <div class="api-header">
                        <span class="badge get">GET</span>
                        <span class="api-path">/api_stats.php?action=dhcp_history</span>
                    </div>
                    <p class="api-desc">å–å¾— DHCP ä¼ºæœå™¨å»¶é²æ­·å²è³‡æ–™</p>

                    <h4>åƒæ•¸ (èˆ‡ system_history ç›¸åŒ)</h4>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code># å›ºå®šæ™‚æ®µ
curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=dhcp_history&hours=6"

# è‡ªè¨‚ç¯„åœ
curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=dhcp_history&start_time=2025-12-22%2008:00&end_time=2025-12-22%2012:00"</code></pre>
                    </div>
                </div>

                <!-- API: Stats 24h -->
                <div class="api-endpoint">
                    <div class="api-header">
                        <span class="badge get">GET</span>
                        <span class="api-path">/api_stats.php?action=stats</span>
                    </div>
                    <p class="api-desc">å–å¾— 24 å°æ™‚çµ±è¨ˆæ‘˜è¦ (avg/min/max)</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=stats"</code></pre>
                    </div>
                </div>

                <h3>DHCP é…ç½® API</h3>

                <!-- API: Get DHCP Servers -->
                <div class="api-endpoint">
                    <div class="api-header">
                        <span class="badge get">GET</span>
                        <span class="api-path">/api_dhcp_config.php</span>
                    </div>
                    <p class="api-desc">å–å¾—æ‰€æœ‰ DHCP ä¼ºæœå™¨é…ç½®</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>curl -sk "https://YOUR_SERVER/health_dashboard/api/api_dhcp_config.php"</code></pre>
                    </div>
                </div>

                <!-- API: Add DHCP Server -->
                <div class="api-endpoint">
                    <div class="api-header">
                        <span class="badge post">POST</span>
                        <span class="api-path">/api_dhcp_config.php</span>
                    </div>
                    <p class="api-desc">æ–°å¢ DHCP ä¼ºæœå™¨</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>curl -sk -X POST -H "Content-Type: application/json" \
  -d '{"ip":"10.1.1.1","hostname":"NEW-DHCP","location":"æ–°æ“šé»"}' \
  "https://YOUR_SERVER/health_dashboard/api/api_dhcp_config.php"</code></pre>
                    </div>
                </div>

                <!-- API: Update DHCP Server -->
                <div class="api-endpoint">
                    <div class="api-header">
                        <span class="badge put">PUT</span>
                        <span class="api-path">/api_dhcp_config.php?ip={IP}</span>
                    </div>
                    <p class="api-desc">ä¿®æ”¹ DHCP ä¼ºæœå™¨</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>curl -sk -X PUT -H "Content-Type: application/json" \
  -d '{"hostname":"Updated-Name","location":"æ–°ä½ç½®"}' \
  "https://YOUR_SERVER/health_dashboard/api/api_dhcp_config.php?ip=10.1.1.1"</code></pre>
                    </div>
                </div>

                <!-- API: Delete DHCP Server -->
                <div class="api-endpoint">
                    <div class="api-header">
                        <span class="badge delete">DELETE</span>
                        <span class="api-path">/api_dhcp_config.php?ip={IP}</span>
                    </div>
                    <p class="api-desc">åˆªé™¤ DHCP ä¼ºæœå™¨</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <pre><code>curl -sk -X DELETE "https://YOUR_SERVER/health_dashboard/api/api_dhcp_config.php?ip=10.1.1.1"</code></pre>
                    </div>
                </div>

                <h3>åŠŸèƒ½é©—è­‰å‘½ä»¤</h3>
                <div class="code-wrapper">
                    <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                    <pre><code># 1. é©—è­‰ API é€£ç·š
curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=latest" | jq .success

# 2. é©—è­‰æ™‚æ®µæŸ¥è©¢
curl -sk "https://YOUR_SERVER/health_dashboard/api/api_stats.php?action=system_history&hours=1" | jq '.data | length'

# 3. é©—è­‰ DHCP é…ç½®
curl -sk "https://YOUR_SERVER/health_dashboard/api/api_dhcp_config.php" | jq '.[].hostname'

# 4. é©—è­‰è³‡æ–™æ”¶é›†
docker exec phpipam_phpipam-cron_1 php /health_check/scripts/collect_stats.php

# 5. é©—è­‰ phpIPAM Tools æ•´åˆ
docker exec phpipam_phpipam-web_1 ls /phpipam/app/tools/health-monitor/</code></pre>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>ğŸ“Š phpIPAM Health Monitor v2.1</p>
            <p>æ–‡ä»¶æ›´æ–°æ™‚é–“ï¼š2025-12-23 13:34</p>
            <p>MG Feng | IT Infrastructure</p>
        </div>
    </div>

    <script>
        function switchTab(tabId) {
            // Remove active from all tabs and contents
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

            // Add active to selected
            document.querySelector(`[onclick="switchTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        function copyCode(btn) {
            const code = btn.parentElement.querySelector('code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                btn.textContent = 'å·²è¤‡è£½!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'è¤‡è£½';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>
</body>

</html>